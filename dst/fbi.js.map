{"version":3,"file":null,"sources":["../src/helpers/utils.js","../src/module.js","../src/task.js","../src/helpers/copy.js","../src/template.js","../src/helpers/options.js","../src/cli.js","../src/fbi.js"],"sourcesContent":["import fs from 'fs'\nimport util from 'util'\nimport path from 'path'\nimport { exec } from 'child_process'\n\nexport function colors() {\n  function colorize(color, text) {\n    const codes = util.inspect.colors[color]\n    return `\\x1b[${codes[0]}m${text}\\x1b[${codes[1]}m`\n  }\n  let returnValue = {}\n  Object.keys(util.inspect.colors).map((color) => {\n    returnValue[color] = (text) => colorize(color, text)\n  })\n  return returnValue\n}\n\n/**\n * type:\n * -1 waring, 0 error, 1 succ\n * bold, italic, underline, inverse, white, grey,\n * black, blue, cyan, green, magenta, red, yellow\n */\nexport function log(msg, type) {\n  if (typeof msg === 'string') {\n    if (type !== undefined) {\n      switch (type) {\n        case -1:\n          msg = colors().grey('FBI => ') + colors().red(msg)\n          break\n        case 0:\n          msg = colors().grey('FBI Error => ') + colors().magenta(msg)\n          break\n        case 1:\n          msg = colors().grey('FBI => ') + colors().cyan(msg)\n          break\n        default:\n          msg = colors().grey('FBI => ') + colors()[type]\n            ? colors()[type](msg)\n            : msg\n      }\n    } else {\n      msg = colors().grey('FBI => ') + msg\n    }\n  }\n  console.log(msg)\n}\n\nexport function cwd(...args) {\n  const arr = [].slice.call(args || [])\n  return path.join.apply(null, [process.cwd()].concat(arr))\n}\n\nexport function join(...args) {\n  const arr = [].slice.call(args || [])\n  return path.join.apply(null, arr)\n}\n\nexport function dir(...args) {\n  const arr = [].slice.call(args || [])\n  return path.join.apply(null, [__dirname, '../'].concat(arr))\n}\n\nexport function merge(target) {\n  var sources = [].slice.call(arguments, 1)\n  sources.forEach(function (source) {\n    for (var p in source)\n      if (typeof source[p] === 'object') {\n        target[p] = target[p] || (Array.isArray(source[p]) ? [] : {})\n        merge(target[p], source[p])\n      } else {\n        target[p] = source[p]\n      }\n  })\n  return target\n}\n\nexport function clone(obj) {\n  return JSON.parse(JSON.stringify(obj));\n}\n\nexport function validJson(data) {\n  try {\n    var o = JSON.parse(data)\n    // JSON.parse(null) returns null, and typeof null === \"object\"\n    if (o && typeof o === 'object') {\n      return o\n    }\n  } catch (e) {\n    return false\n  }\n}\n\nexport function read(_p, charset) {\n  return new Promise((resolve, reject) => {\n    fs.readFile(_p, charset || 'utf8', (err, data) => {\n      return err ? reject(err) : resolve(data)\n    })\n  })\n}\n\nexport function write(file, data) {\n  return new Promise((resolve, reject) => {\n    fs.writeFile(file, data, (err) => {\n      return err ? reject(err) : resolve(true)\n    })\n  })\n}\n\nexport function exist(_p, opts) {\n  return new Promise((resolve, reject) => {\n    fs.access(_p, opts || (fs.R_OK | fs.W_OK), err => {\n      return err ? resolve(false) : resolve(true)\n    })\n  })\n}\n\nexport function existSync(src) {\n  try {\n    fs.accessSync(src, fs.R_OK | fs.W_OK)\n    return true\n  } catch (e) {\n    return false\n  }\n}\n\nexport function install(source, rootPath, command, opts) {\n  const prevDir = process.cwd()\n  let pkgs = ''\n  let info = ''\n\n  Object.keys(source).map(item => {\n    pkgs += `${item}@${source[item]} `\n    info += `\n       ${item}@${source[item]} `\n  })\n  info += `\n       ${opts ? opts : ''}\n    to:${rootPath}\n  `;\n\n  process.chdir(rootPath)\n  const cmd = `${command} install ${pkgs} ${opts ? opts : ''}`\n  log(`${command} install ${info}`)\n  return new Promise((resolve, reject) => {\n    exec(cmd, (error, stdout, stderr) => {\n      process.chdir(prevDir)\n      if (error) {\n        const msg = stderr.toString()\n        log(msg, 0)\n        return reject(msg)\n      }\n\n      log(`\n${stdout}`)\n      resolve(stdout)\n    })\n  })\n}\n\nexport function copyFile(source, target, quiet) {\n  return new Promise((resolve, reject) => {\n    var rd = fs.createReadStream(source)\n    rd.on('error', reject)\n    var wr = fs.createWriteStream(target)\n    wr.on('error', reject)\n    wr.on('finish', () => {\n      if (!quiet) {\n        log(`copied ${source} => ${target}`)\n      }\n      resolve()\n    })\n    rd.pipe(wr)\n  })\n}\n\nexport function readDir(folder, ignore) {\n  function valid(item) {\n    return !ignore.includes(item)\n  }\n  return new Promise((resolve, reject) => {\n    fs.readdir(folder, (err, ret) => {\n      if (err) {\n        reject(err)\n      }\n      if (ignore && ignore.length) {\n        ret = ret.filter(valid)\n      }\n      resolve(ret)\n    })\n  })\n}\n\nexport function mkdir(p) {\n  return new Promise((resolve, reject) => {\n    fs.mkdir(p, err => {\n      return err ? reject(err) : resolve()\n    })\n  })\n}\n\nexport function rmfile(p, callback) {\n  fs.lstat(p, (err, stat) => {\n    if (err) callback.call(null, err)\n    else if (stat.isDirectory()) rmdir(p, callback)\n    else fs.unlink(p, callback)\n  })\n}\n\nexport function rmdir(dir, callback) {\n  fs.readdir(dir, (err, files) => {\n    if (err) callback.call(null, err)\n    else if (files.length) {\n      var i, j\n      for (i = j = files.length; i--;) {\n        rmfile(join(dir, files[i]), err => {\n          if (err) callback.call(null, err)\n          else if (--j === 0) fs.rmdir(dir, callback)\n        })\n      }\n    }\n    else fs.rmdir(dir, callback)\n  })\n}\n\nexport function isTaskFile(file) {\n  return path.extname(file) === '.js' && file.indexOf('config') < 0\n}\n\nexport function isTemplate(name) {\n  return path.extname(name) === '' && name.indexOf('.') !== 0\n}\n\nexport function isTaskName(item) {\n  // return !['-g'].includes(item)\n  return item.indexOf('-') !== 0\n}\n\nexport function isAbsolute(str) {\n  return /^(?:\\/|(?:[A-Za-z]:)?[\\\\|\\/])/.test(str);\n}\n\nexport function isRelative(str) {\n  return /^\\.?\\.\\//.test(str);\n}\n\nexport function normalize(str) {\n  return str.replace(/\\\\/g, '/');\n}\n\nexport function basename(src, ext) {\n  return path.basename(src, ext)\n}\n\n/**\n * arr:\n * build -p -w serve -3000 deploy -10.11.11.1\n * prefix: -\n *\n * return\n\n  { build: { params: [ 'p', 'w' ] },\n    serve: { params: [ '3000' ] },\n    deploy: { params: [ '10.11.11.1' ] }\n  }\n\n */\nexport function parseArgvs(arr, prefix) {\n\n  if (!arr.length || !prefix) {\n    log('Usage: let ret = parseArgvs(arr, prefix)', 0)\n    return arr\n  }\n\n  let ret = {}\n\n  arr.reduce((prev, curr, idx) => {\n    if (curr.indexOf(prefix) === 0) {\n      if (ret[prev]) {\n        if (Array.isArray(ret[prev]['params'])) {\n          ret[prev]['params'].push(curr.slice(prefix.length))\n        } else {\n          ret[prev]['params'] = [curr.slice(prefix.length)]\n        }\n      }\n      return prev\n    } else {\n      ret[curr] = {}\n      return curr\n    }\n  }, arr[0])\n\n  return ret\n}\n\nexport function genTaskHelpTxt(all) {\n  if (!Object.keys(all).length) {\n    return ''\n  }\n  let txt = `\n    Tasks:\n    `;\n  ['global', 'template', 'local'].map(type => {\n    if (all[type].length) {\n      all[type].map(item => {\n        txt += `\n      ${item.name} ${item.alias} <${type}>`;\n      })\n    }\n  })\n  return txt\n}\n\nexport function genTmplHelpTxt(all) {\n  if (!all.length) {\n    return ''\n  }\n  let txt = `\n\n    Templates:\n    `;\n  all.map(item => {\n    txt += `\n      ${item}`;\n  })\n  return txt\n}\n\nexport function genNpmscriptsHelpTxt(all) {\n  if (!Object.keys(all).length) {\n    return ''\n  }\n  let txt = `\n\n    npm scrips:\n    `;\n  Object.keys(all).map(item => {\n    txt += `\n      ${item}: '${all[item]}'`;\n  })\n  return txt\n}","import {\n  cwd, dir, join, log, exist, isRelative\n} from './helpers/utils'\n\nexport default class Module {\n\n  constructor(opts) {\n    /**\n     * modules find path:\n     *\n     * 1. current folder ï¼> process.cwd()/node_modules\n     * 2. template folder => data/templates/template/node_modules\n     * 3. fbi global folder => data/node_modules\n     * 4. system globale folder => username/node_modules\n     */\n    this.modulePaths = [cwd('node_modules')]\n    if (opts.template) {\n      this.modulePaths.push(\n        join(opts.data.templates, opts.template, 'node_modules')\n      )\n    }\n    this.modulePaths.push(join(opts.data.tasks, 'node_modules'))\n    this.modulePaths.push('') // global\n\n    this.opts = opts\n  }\n\n  get(name, type) {\n    let ret\n\n    if (isRelative(name)) {\n      // local => template\n      try {\n        const localTasks = cwd(this.opts.paths.tasks)\n        const found = require.resolve(join(localTasks, name))\n        ret = localTasks\n      } catch (e) {\n        try {\n          const tmplTasks = join(this.opts.data.templates, this.opts.template, this.opts.paths.tasks)\n          const found = require.resolve(join(tmplTasks, name))\n          ret = tmplTasks\n        } catch (e) {\n          log(`can't find module ${name} in template '${this.opts.template}'`, 0)\n        }\n      }\n    } else {\n      for (let item of this.modulePaths) {\n        let _p = join(item, name)\n        try {\n          let found = require.resolve(_p)\n\n          if (found) {\n            ret = item ? item : 'global'\n            break\n          }\n        } catch (e) {\n\n        }\n      }\n    }\n    return ret\n  }\n}","import fs from 'fs'\nimport vm from 'vm'\nimport Module from './module'\nimport {\n  dir, join, cwd, readDir, log, read, exist,\n  existSync, isTaskFile, basename, isRelative\n} from './helpers/utils'\n\nexport default class Task {\n\n  constructor() {\n    this.tasks = {}\n  }\n\n  async get(name, type, opts) {\n    // if alias, get fullname from alias\n    // let desc = ''\n    if (opts.alias && opts.alias[name]) {\n      name = opts.alias[name]\n      // desc = opts.alias[name].split(' ')[1]\n    }\n\n    // local task > tempalte task => global task\n    let ret = {\n      name: name,\n      cnt: '',\n      type: '',\n      path: ''\n      // ,\n      // desc: desc\n    }\n\n    async function find(_path, _type) {\n      _path = _path + '.js'\n      let _exist = existSync(_path)\n      if (_exist) {\n        ret.cnt = await read(_path)\n        ret.type = _type\n        ret.path = _path\n      }\n    }\n\n    // find in local\n    if (type === 'local') {\n      await find(cwd(opts.paths.tasks, name), type)\n    }\n\n    // find in template\n    if (!ret.cnt && opts.template && opts.template !== '') {\n      await find(join(\n        opts.data.templates,\n        opts.template,\n        opts.paths.tasks,\n        name), 'template')\n    }\n\n    // find in global\n    if (!ret.cnt || type === 'global') {\n      await find(join(opts.data.tasks, name), 'global')\n    }\n\n    return ret\n  }\n\n  async all(opts, justNames, justAvailable) {\n    const _this = this\n    let names = {\n      local: new Set(),\n      global: new Set(),\n      template: new Set()\n    }\n\n    async function collect(_dir, type) {\n      let _exist = await exist(_dir)\n      let _modules\n      if (_exist) {\n        _modules = await readDir(_dir)\n        _modules = _modules.filter(isTaskFile)\n        if (justNames) {\n          _modules.map(item => {\n            item = basename(item, '.js')\n            names[type].add(item)\n          })\n        } else if (_modules.length) {\n          await Promise.all(_modules.map(async (item) => {\n            _this.tasks[basename(item, '.js')] = await read(join(_dir, item))\n          }))\n        }\n      }\n    }\n\n    // template tasks\n    if (opts.template && opts.template !== '') {\n      await collect(join(\n        opts.data.templates,\n        opts.template,\n        opts.paths.tasks), 'template')\n    }\n\n    // global tasks\n    await collect(join(opts.data.tasks), 'global')\n\n    // locals\n    await collect(cwd(opts.paths.tasks), 'local')\n\n    if (justAvailable) {\n      for (let item of names.template.values()) {\n        if (names.local.has(item)) {\n          names.template.delete(item)\n        }\n      }\n      for (let item of names.global.values()) {\n        if (names.local.has(item)) {\n          names.global.delete(item)\n        }\n        if (names.template.has(item)) {\n          names.global.delete(item)\n        }\n      }\n    }\n\n    if (justNames) {\n      Object.keys(names).map(item => {\n        names[item] = Array.from(names[item]) // Set => Array\n\n        // alias\n        for (let i = 0, len = names[item].length; i < len; i++) {\n          let alias = ''\n          let description = ''\n          if (opts.alias) {\n            Object.keys(opts.alias).map(a => {\n              // const name = opts.alias[a].split(' ')[0]\n              // const desc = opts.alias[a].split(' ')[1]\n              // if(name === names[item][i]){\n              //   alias = a\n              //   description = desc\n              // }\n              if (opts.alias[a] === names[item][i]) {\n                alias = a\n              }\n            })\n          }\n\n          names[item][i] = {\n            name: names[item][i],\n            alias: alias,\n            desc: description\n          }\n        }\n      })\n    }\n\n    return justNames ? names : _this.tasks\n  }\n\n  run(name, ctx, taskObj) {\n    let taskCnt = taskObj.cnt || this.tasks[name]\n    const module = new Module(ctx.options)\n\n    function requireResolve(mod) {\n      // find mod path\n      let mod_path = module.get(mod, taskObj.type)\n      if (mod_path && mod_path !== 'global') {\n        return require(join(mod_path, mod))\n      } else {\n        return mod ? require(mod) : require\n      }\n    }\n\n    let code = `\n    (function(require, ctx) {\n      if(!ctx.next || ctx.next === 'false') return false;\n\n      ctx.log('Running ${taskObj.type} task \"${taskObj.name}${taskObj.params}\\\"...', 1);\n      try {\n        ${taskCnt}\n      } catch (e) {\n        ctx.log('task function error', 0)\n        ctx.log(e, 0)\n      }\n    })`\n\n    vm.runInThisContext(code, {\n      filename: `${taskObj.name}.js`,\n      lineOffset: -3,\n      displayErrors: true\n    })(requireResolve, ctx)\n  }\n}","import fs from 'fs'\nimport path from 'path'\n\nlet ignore = []\n\nexport default (src, dst, ign) => {\n  ignore = ign ? ign : ignore\n  copy(src, dst, walk)\n}\n\n// src: dir or file\n// dst: dir\nfunction walk(src, dst) {\n  const type = fs.statSync(src)\n\n  if (type.isDirectory()) {\n    return fs.readdirSync(src).filter(f => {\n      if (ignore.includes(f)) {\n        return false\n      } else if (f[0] === '.' && ignore.includes('.')) {\n        return false\n      } else {\n        return true\n      }\n    }).map(f => {\n      let\n        _src = path.join(src, f),\n        _dst = path.join(dst, f),\n        stat = fs.statSync(_src),\n        readable,\n        writable\n\n      if (stat.isDirectory()) {\n        copy(_src, _dst, walk)\n      } else {\n        _copy(_src, _dst)\n      }\n    })\n  } else {\n    return _copy(src, path.join(dst, path.basename(src)))\n  }\n}\n\nfunction _copy(src, dst) {\n  let\n    readable,\n    writable\n\n  readable = fs.createReadStream(src)\n  writable = fs.createWriteStream(dst)\n  readable.pipe(writable)\n\n  let _path = path.relative(process.cwd(), dst)\n  console.log(`copied => ${_path}`)\n}\n\nfunction copy(src, dst, cb) {\n  try {\n    fs.accessSync(dst)\n    cb(src, dst)\n  } catch (e) {\n    fs.mkdirSync(dst)\n    cb(src, dst)\n\n    // fs.mkdir(dst, () => {\n    //   cb(src, dst)\n    // })\n  }\n}","import {\n  cwd, dir, join, log, exist,\n  existSync, readDir, isTemplate\n} from './helpers/utils'\nimport copy from './helpers/copy'\n\nexport default class Template {\n\n  constructor() {\n  }\n\n  async copy(name, dst, opts) {\n    if (!name) {\n      return false\n    }\n    let ret = false\n    const src = join(opts.data.templates, name)\n    const has = existSync(src)\n\n    if (has) {\n      copy(src, dst, ['node_modules', 'dst', 'dist'])\n      return true\n    }\n    return ret\n  }\n\n  async all(opts) {\n    let templates = await readDir(join(opts.data.templates))\n    templates = templates.filter(isTemplate)\n    return templates\n  }\n\n}","import { merge } from './utils'\n\nexport const defaultOptions = {\n  // template: 'basic',\n  task_param_prefix: '-',\n  paths: {\n    tasks: 'fbi/',\n    options: 'fbi/config.js'\n  },\n  data: {\n    root: './data',\n    tasks: './data/tasks',\n    templates: './data/templates'\n  },\n  server: {\n    root: './',\n    host: 'localhost',\n    port: 8888\n  },\n  npm: {\n    alias: 'npm',\n    // options:'--save-dev --registry=https://registry.npm.taobao.org'\n    options: '--save-dev'\n  }\n}\n\nexport function getOptions(opts) {\n  return merge(defaultOptions, opts || {})\n}","import { createInterface } from 'readline'\nimport Task from './task'\nimport Module from './module'\nimport Template from './template'\nimport copy from './helpers/copy'\nimport { getOptions, defaultOptions } from './helpers/options'\nimport { version } from '../package.json'\nimport {\n  cwd, dir, join, exist, existSync, readDir,\n  log, merge, read, write, install, copyFile,\n  isTaskName, isTaskFile, basename, parseArgvs,\n  rmdir, rmfile, mkdir, isAbsolute, clone,\n  genTaskHelpTxt, genTmplHelpTxt, genNpmscriptsHelpTxt\n} from './helpers/utils'\n\nlet helps =\n  `\n    Usage:\n\n      fbi [command]           run command\n      fbi [task]              run a local preference task\n      fbi [task] -g           run a global task\n      fbi [task] -t           run a template task\n\n    Commands:\n\n      ls, list                list all tasks & templates\n      init [template]         init a new project via template\n      add-task                add task files in current folder\n      add-tmpl [name]         add current folder as a template named [name]\n      rm-task [name]          remove task\n      rm-tmpl [name]          remove template\n      cat [task][-t, -g]      cat task content\n      i, install              install dependencies\n      i -f, install -f        install dependencies force\n      -h, --help              output usage information\n      -v, --version           output the version number\n`\n\nconst task = new Task()\nconst template = new Template()\n\nexport default class Cli {\n\n  constructor(argvs) {\n    this.argvs = argvs\n    this.next = true\n    this.log = log\n    this.options = {}\n    this._ = {\n      cwd, dir, join, exist, existSync, readDir,\n      log, merge, read, write, install, copyFile,\n      isTaskName, isTaskFile\n    }\n\n      ; (async () => {\n        try {\n          this.version()\n          await this.config()\n          await this.help()\n          await this.init()\n          await this.install()\n          await this.remove()\n          await this.cat()\n          await this.list()\n          await this.add()\n          this.backup()\n          this.recover()\n          await this.run()\n        } catch (e) {\n          log(e, 0)\n        }\n      })()\n  }\n\n  version() {\n    if (!this.next) return\n\n    if (this.argvs[0] === '-v'\n      || this.argvs[0] === '--verison') {\n      this.next = false\n      console.log(version)\n    }\n  }\n\n  async help() {\n    if (!this.next) return\n\n    if (!this.argvs.length\n      || this.argvs[0] === '-h'\n      || this.argvs[0] === '--help') {\n      this.next = false\n\n      helps += genTaskHelpTxt(await task.all(this.options, true, true))\n      helps += genTmplHelpTxt(await template.all(this.options))\n      helps += `\n      `\n      console.log(helps)\n    }\n  }\n\n  async config() {\n    if (!this.next) return\n\n    // user options > tempalte options > default options\n    try {\n      // user options\n      const userOptionsPath = cwd(defaultOptions.paths.options)\n      this.isfbi = await exist(userOptionsPath)\n      const userOptions = this.isfbi ? require(userOptionsPath) : null\n\n      // merge user options\n      this.options = getOptions(userOptions)\n\n\n      let data = clone(this.options.data)\n      // parse data path\n      Object.keys(data).map(item => {\n        if (!isAbsolute(data[item])) {\n          data[item] = dir(data[item])\n        }\n      })\n\n      // template options\n      if (userOptions && userOptions.template) {\n        this.options['node_modules_path'] = join(\n          data.templates,\n          userOptions.template,\n          'node_modules'\n        )\n\n        const templateOptionsPath = join(\n          data.templates,\n          userOptions.template,\n          this.options.paths.options\n        )\n\n        if (existSync(templateOptionsPath)) {\n          const templateOptions = require(templateOptionsPath)\n          // merge template options\n          merge(this.options, templateOptions)\n        }\n      }\n      // merge user options\n      merge(this.options, userOptions)\n      // parse data path\n      Object.keys(this.options.data).map(item => {\n        if (!isAbsolute(this.options.data[item])) {\n          this.options.data[item] = dir(this.options.data[item])\n        }\n      })\n    } catch (e) {\n      log(e)\n    }\n  }\n\n  async install() {\n    if (!this.next) return\n\n    if (this.argvs[0] === 'i' || this.argvs[0] === 'install') {\n      this.next = false\n\n      let force = this.argvs[1] === '-f' || this.argvs[1] === '-force'\n\n      let localdeps = {}\n      let tmplDeps = {}\n      let taskDeps = {}\n      const opts = this.options\n\n      // local package.json => devDependencies\n      if (await exist(cwd('package.json'))) {\n        localdeps = require(cwd('package.json')).devDependencies\n      }\n\n      // template package.json => devDependencies\n      if (opts.template) {\n        const tmplPkg = join(opts.data.templates, opts.template, 'package.json')\n        const tmplPkg_exist = await exist(tmplPkg)\n        if (tmplPkg_exist) {\n          const tmplPkg_dev = require(tmplPkg)['devDependencies']\n          tmplDeps = merge(tmplPkg_dev, localdeps)\n        }\n        if (Object.keys(tmplDeps).length) {\n          let tmplPkgCnt = require(tmplPkg)\n          tmplPkgCnt['devDependencies'] = tmplDeps\n          await write(tmplPkg, JSON.stringify(tmplPkgCnt, null, 2))\n        }\n      }\n\n      // task package.json => devDependencies\n      else {\n        const taskPkg = join(opts.data.tasks, 'package.json')\n        const taskPkg_exist = await exist(taskPkg)\n        if (taskPkg_exist) {\n          const taskPkg_dev = require(taskPkg).devDependencies\n          taskDeps = merge(taskPkg_dev, localdeps)\n        }\n        if (Object.keys(taskDeps).length) {\n          let taskPkgCnt = require(taskPkg)\n          taskPkgCnt['devDependencies'] = taskDeps\n          await write(taskPkg, JSON.stringify(taskPkgCnt, null, 2))\n        }\n      }\n\n      const npms = opts.npm\n\n      const installTmplDeps = Object.keys(tmplDeps).length\n        ? await install(tmplDeps, join(opts.data.templates, opts.template), npms.alias, npms.options)\n        : Promise.resolve()\n\n      const installTaskDeps = Object.keys(taskDeps).length\n        ? await install(taskDeps, opts.data.tasks, npms.alias, npms.options)\n        : Promise.resolve()\n\n      // install\n      Promise.all([installTmplDeps, installTaskDeps]).then(ret => {\n        log('All Dependencies Installed', 1)\n      }).catch(err => {\n        log(err, 0)\n      })\n\n    }\n  }\n\n  async init() {\n    if (!this.next) return\n\n    if (this.argvs[0] === 'init') {\n      this.next = false\n\n      if (!this.argvs[1]) {\n        return log(`Usage: fbi init [template name]`, 0)\n      }\n      // log(this.argvs[1].match(/^[^\\\\/:*\"\"<>|,]+$/i))\n      try {\n        const name = this.argvs[1]\n        let succ = await template.copy(name, cwd(), this.options)\n        if (succ) {\n          log(`Template '${name}' init in current folder`, 1)\n        } else {\n          log(`Template '${name}' not found`, 0)\n        }\n      } catch (e) {\n        log(e)\n      }\n    }\n  }\n\n  async remove() {\n    if (!this.next) return\n\n    if (this.argvs[0] === 'rm-task') {\n      this.next = false\n\n      let mods = this.argvs.slice(1)\n      if (!mods.length) {\n        log(`Usage: fbi rm-task [name]`, 0)\n        process.exit(0)\n      }\n      let tasks_path = this.options.data.tasks\n      let tmpl_name\n      if (mods[0].indexOf('-') === 0) {\n        tmpl_name = mods[0].slice(1)\n        mods = mods.splice(1, 1)\n        if (tmpl_name !== '') {\n          if (mods.length) {\n            const tmpl_exist = await exist(join(this.options.data.templates, tmpl_name))\n            if (tmpl_exist) {\n              tasks_path = join(this.options.data.templates, tmpl_name, this.options.paths.tasks)\n            } else {\n              log(`template '${tmpl_name}' not found`, 0)\n              process.exit(0)\n            }\n          } else {\n            log(`Usage: fbi rm-task -[template] [task]`, 0)\n            process.exit(0)\n          }\n        }\n        else {\n          log(`Usage: fbi rm-task -[template] [task]`, 0)\n          process.exit(0)\n        }\n      }\n      const tasks = await readDir(tasks_path)\n      mods.map(async (item) => {\n        item = item + '.js'\n        if (tasks.includes(item)) {\n          try {\n            rmfile(join(tasks_path, item), err => {\n              if (err) {\n                log(err, 0)\n              }\n              log(`task ${basename(item, '.js')} ${tmpl_name ? 'in ' + tmpl_name + ' ' : ''}removed`, 1)\n            })\n          } catch (e) {\n            log(e, 0)\n          }\n        } else {\n          log(`task '${basename(item, '.js')}' ${tmpl_name ? 'in ' + tmpl_name + ' ' : ''} not found`, 0)\n        }\n      })\n    }\n\n    if (this.argvs[0] === 'rm-tmpl') {\n      this.next = false\n\n      const mods = this.argvs.slice(1)\n      if (!mods.length) {\n        log(`Usage: fbi rm-tmpl [name]`, 0)\n        process.exit(0)\n      }\n      const tmpls = await readDir(this.options.data.templates)\n      mods.map(async (item) => {\n        if (tmpls.includes(item)) {\n          try {\n            rmdir(join(this.options.data.templates, item), err => {\n              if (err) {\n                log(err, 0)\n              }\n              log(`template '${item}' removed`, 1)\n            })\n          } catch (e) {\n            log(e, 0)\n          }\n        } else {\n          log(`template '${item}' not found`, 0)\n        }\n      })\n    }\n  }\n\n  async cat() {\n    if (!this.next) return\n\n    if (this.argvs[0] === 'cat') {\n      this.next = false\n\n      if (!this.argvs[1]) {\n        return log(`Usage: fbi cat [task] [-t, -g]`, 0)\n      }\n\n      const name = this.argvs[1]\n      let type = 'local'\n      if (this.argvs[2] === '-g') {\n        type = 'global'\n      } else if (this.argvs[2] === '-t') {\n        type = 'template'\n      }\n\n      const taskObj = await task.get(name, type, this.options)\n      log(`file path: ${taskObj.path}`)\n      log(`${taskObj.type} task ${name}'s content:\n\n${taskObj.cnt}\n        `)\n    }\n  }\n\n  async list() {\n    if (!this.next) return\n\n    if (this.argvs[0] === 'ls'\n      || this.argvs[0] === 'list') {\n      this.next = false\n\n      let helps = genTaskHelpTxt(await task.all(this.options, true, false))\n\n      helps += genTmplHelpTxt(await template.all(this.options))\n\n      if (await exist(cwd('package.json'))) {\n        const usrpkg = require(cwd('package.json'))\n        if (usrpkg.scripts && Object.keys(usrpkg.scripts).length > 0) {\n          helps += genNpmscriptsHelpTxt(usrpkg.scripts)\n        }\n      }\n\n      helps += `\n      `\n\n      console.log(helps)\n    }\n  }\n\n  async add() {\n    if (!this.next) return\n\n    if (this.argvs[0] === 'add-tmpl') {\n      this.next = false\n\n      // add template\n      const name = this.argvs[1] || basename(cwd(), '')\n      const isExist = await exist(join(this.options.data.templates, name))\n\n      if (isExist) {\n        log(`tempalte '${name}' already exist, type 'y' to replace, or type name to create new one`, -1)\n        let\n          rl = createInterface(process.stdin, process.stdout),\n          prompts = ['name'],\n          p = 0,\n          data = {}\n        let get = function () {\n          rl.setPrompt(prompts[p] + ': ')\n          rl.prompt()\n\n          p++\n        }\n        get()\n        rl.on('line', (line) => {\n          data[prompts[p - 1]] = line\n          if (p === prompts.length) {\n            return rl.close()\n          }\n          get()\n        }).on('close', async () => {\n          if (data.name === 'y') {\n            copy(cwd(), join(this.options.data.templates, name), ['dst', 'dist'])\n          } else if (data.name === '') {\n            log('name can\\'t be empty', 0)\n          } else {\n            const isExist2 = await exist(join(this.options.data.templates, data.name))\n            if (isExist2) {\n              log(`${data.name} already exist too`, 0)\n              process.exit(0)\n            } else {\n              copy(cwd(), join(this.options.data.templates, data.name), ['dst', 'dist'])\n            }\n          }\n        })\n      } else {\n        copy(cwd(), join(this.options.data.templates, name), ['dst', 'dist'])\n      }\n    }\n\n    if (this.argvs[0] === 'add-task') {\n      this.next = false\n\n      if (!this.argvs[1]) {\n        log(`Usage: fbi add-task [*] or [name.js]`, 0)\n      } else {\n        let ts = this.argvs.slice(1)\n        ts = ts.filter(isTaskFile)\n        if (!ts.length) {\n          log(`no task found.`, 0)\n        } else {\n          ts.map(async (item) => {\n            const taskdir = join(this.options.data.tasks)\n            const taskdir_exist = await exist(taskdir)\n            const task_exist = await exist(join(taskdir, item))\n            if (!taskdir_exist) {\n              await mkdir(taskdir)\n            }\n            try {\n              await copyFile(cwd(item), join(taskdir, item), 'quiet')\n              log(`task '${basename(item, '.js')}' ${task_exist ? 'updated' : 'added'}`, 1)\n            } catch (e) {\n              log(e, 0)\n            }\n          })\n        }\n      }\n    }\n  }\n\n  backup() {\n    if (!this.next) return\n\n    if (this.argvs[0] === 'backup') {\n      this.next = false\n\n      const _dir = 'fbi-data-bak-' + Date.now()\n\n      log('Start to backup data...', 1)\n      copy(this.options.data.root, cwd(_dir), ['node_modules', 'dst', '.DS_Store'])\n    }\n  }\n\n  recover() {\n    if (!this.next) return\n\n    if (this.argvs[0] === 'recover') {\n      this.next = false\n\n      log('Start to recover data...', 1)\n      copy(cwd(), this.options.data.root, ['node_modules', 'dst', '.DS_Store'])\n    }\n  }\n\n  async run() {\n    if (!this.next) return\n\n    let cmds = this.argvs\n    if (this.argvs.length > 0) {\n      let ret\n      const prefix = this.options.task_param_prefix\n      try {\n        ret = parseArgvs(cmds, prefix)\n      } catch (e) {\n        log(`task params parsed error`, 0)\n        log(e)\n      }\n\n      if (Object.keys(ret).length) {\n        Object.keys(ret).map(async (item) => {\n          try {\n            let taskType = 'local'\n            let itemParams = ret[item]['params']\n            if (itemParams) {\n              switch (itemParams[0]) {\n                case 't':\n                  taskType = 'template'\n                  itemParams.splice(0, 1)\n                  break\n                case 'g':\n                  taskType = 'global'\n                  itemParams.splice(0, 1)\n                  break\n              }\n            }\n            const taskObj = await task.get(item, taskType, this.options)\n            if (taskObj.cnt) {\n              taskObj['params'] = (itemParams && itemParams.length)\n                ? ' ' + prefix + itemParams.join(' ' + prefix)\n                : ''\n              this['taskParams'] = (itemParams && itemParams.length)\n                ? itemParams\n                : null\n              task.run(item, this, taskObj)\n            } else {\n              log(`Task not found: '${item}`, 0)\n            }\n          } catch (e) {\n            log(e, 0)\n          }\n        })\n      }\n    }\n  }\n\n}\n\n/** TODO:\n * backup-done\n * recover-done\n * handbook\n *\n */\n\n","import Cli from './cli'\n\nexport default class Fbi {\n\n  constructor() {\n    this.Cli = Cli\n  }\n\n  static get cli() {\n    return Cli\n  }\n\n  run(cmds) {\n    if (!cmds) {\n      return\n    }\n\n    new Fbi.cli(typeof cmds === 'string' ? [cmds] : cmds)\n  }\n\n}\n\n"],"names":["babelHelpers.typeof","_copy","_version","_install","createInterface"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAKO,SAAS,MAAT,GAAkB;WACd,QAAT,CAAkB,KAAlB,EAAyB,IAAzB,EAA+B;QACvB,QAAQ,KAAK,OAAL,CAAa,MAAb,CAAoB,KAApB,CAAd;uBACe,MAAM,CAAN,CAAf,SAA2B,IAA3B,eAAuC,MAAM,CAAN,CAAvC;;MAEE,cAAc,EAAlB;SACO,IAAP,CAAY,KAAK,OAAL,CAAa,MAAzB,EAAiC,GAAjC,CAAqC,UAAC,KAAD,EAAW;gBAClC,KAAZ,IAAqB,UAAC,IAAD;aAAU,SAAS,KAAT,EAAgB,IAAhB,CAAV;KAArB;GADF;SAGO,WAAP;;;;;;;;;AASF,AAAO,SAAS,GAAT,CAAa,GAAb,EAAkB,IAAlB,EAAwB;MACzB,OAAO,GAAP,KAAe,QAAnB,EAA6B;QACvB,SAAS,SAAb,EAAwB;cACd,IAAR;aACO,CAAC,CAAN;gBACQ,SAAS,IAAT,CAAc,SAAd,IAA2B,SAAS,GAAT,CAAa,GAAb,CAAjC;;aAEG,CAAL;gBACQ,SAAS,IAAT,CAAc,eAAd,IAAiC,SAAS,OAAT,CAAiB,GAAjB,CAAvC;;aAEG,CAAL;gBACQ,SAAS,IAAT,CAAc,SAAd,IAA2B,SAAS,IAAT,CAAc,GAAd,CAAjC;;;gBAGM,SAAS,IAAT,CAAc,SAAd,IAA2B,SAAS,IAAT,CAA3B,GACF,SAAS,IAAT,EAAe,GAAf,CADE,GAEF,GAFJ;;KAZN,MAgBO;YACC,SAAS,IAAT,CAAc,SAAd,IAA2B,GAAjC;;;UAGI,GAAR,CAAY,GAAZ;;;AAGF,AAAO,SAAS,GAAT,GAAsB;oCAAN,IAAM;QAAA;;;MACrB,MAAM,GAAG,KAAH,CAAS,IAAT,CAAc,QAAQ,EAAtB,CAAZ;SACO,KAAK,IAAL,CAAU,KAAV,CAAgB,IAAhB,EAAsB,CAAC,QAAQ,GAAR,EAAD,EAAgB,MAAhB,CAAuB,GAAvB,CAAtB,CAAP;;;AAGF,AAAO,SAAS,IAAT,GAAuB;qCAAN,IAAM;QAAA;;;MACtB,MAAM,GAAG,KAAH,CAAS,IAAT,CAAc,QAAQ,EAAtB,CAAZ;SACO,KAAK,IAAL,CAAU,KAAV,CAAgB,IAAhB,EAAsB,GAAtB,CAAP;;;AAGF,AAAO,SAAS,GAAT,GAAsB;qCAAN,IAAM;QAAA;;;MACrB,MAAM,GAAG,KAAH,CAAS,IAAT,CAAc,QAAQ,EAAtB,CAAZ;SACO,KAAK,IAAL,CAAU,KAAV,CAAgB,IAAhB,EAAsB,CAAC,SAAD,EAAY,KAAZ,EAAmB,MAAnB,CAA0B,GAA1B,CAAtB,CAAP;;;AAGF,AAAO,SAAS,KAAT,CAAe,MAAf,EAAuB;MACxB,UAAU,GAAG,KAAH,CAAS,IAAT,CAAc,SAAd,EAAyB,CAAzB,CAAd;UACQ,OAAR,CAAgB,UAAU,MAAV,EAAkB;SAC3B,IAAI,CAAT,IAAc,MAAd;UACMA,QAAO,OAAO,CAAP,CAAP,MAAqB,QAAzB,EAAmC;eAC1B,CAAP,IAAY,OAAO,CAAP,MAAc,MAAM,OAAN,CAAc,OAAO,CAAP,CAAd,IAA2B,EAA3B,GAAgC,EAA9C,CAAZ;cACM,OAAO,CAAP,CAAN,EAAiB,OAAO,CAAP,CAAjB;OAFF,MAGO;eACE,CAAP,IAAY,OAAO,CAAP,CAAZ;;;GANN;SASO,MAAP;;;AAGF,AAAO,SAAS,KAAT,CAAe,GAAf,EAAoB;SAClB,KAAK,KAAL,CAAW,KAAK,SAAL,CAAe,GAAf,CAAX,CAAP;;;AAGF,AAYA,AAAO,SAAS,IAAT,CAAc,EAAd,EAAkB,OAAlB,EAA2B;SACzB,IAAI,OAAJ,CAAY,UAAC,OAAD,EAAU,MAAV,EAAqB;OACnC,QAAH,CAAY,EAAZ,EAAgB,WAAW,MAA3B,EAAmC,UAAC,GAAD,EAAM,IAAN,EAAe;aACzC,MAAM,OAAO,GAAP,CAAN,GAAoB,QAAQ,IAAR,CAA3B;KADF;GADK,CAAP;;;AAOF,AAAO,SAAS,KAAT,CAAe,IAAf,EAAqB,IAArB,EAA2B;SACzB,IAAI,OAAJ,CAAY,UAAC,OAAD,EAAU,MAAV,EAAqB;OACnC,SAAH,CAAa,IAAb,EAAmB,IAAnB,EAAyB,UAAC,GAAD,EAAS;aACzB,MAAM,OAAO,GAAP,CAAN,GAAoB,QAAQ,IAAR,CAA3B;KADF;GADK,CAAP;;;AAOF,AAAO,SAAS,KAAT,CAAe,EAAf,EAAmB,IAAnB,EAAyB;SACvB,IAAI,OAAJ,CAAY,UAAC,OAAD,EAAU,MAAV,EAAqB;OACnC,MAAH,CAAU,EAAV,EAAc,QAAS,GAAG,IAAH,GAAU,GAAG,IAApC,EAA2C,eAAO;aACzC,MAAM,QAAQ,KAAR,CAAN,GAAuB,QAAQ,IAAR,CAA9B;KADF;GADK,CAAP;;;AAOF,AAAO,SAAS,SAAT,CAAmB,GAAnB,EAAwB;MACzB;OACC,UAAH,CAAc,GAAd,EAAmB,GAAG,IAAH,GAAU,GAAG,IAAhC;WACO,IAAP;GAFF,CAGE,OAAO,CAAP,EAAU;WACH,KAAP;;;;AAIJ,AAAO,SAAS,OAAT,CAAiB,MAAjB,EAAyB,QAAzB,EAAmC,OAAnC,EAA4C,IAA5C,EAAkD;MACjD,UAAU,QAAQ,GAAR,EAAhB;MACI,OAAO,EAAX;MACI,OAAO,EAAX;;SAEO,IAAP,CAAY,MAAZ,EAAoB,GAApB,CAAwB,gBAAQ;YACnB,IAAX,SAAmB,OAAO,IAAP,CAAnB;0BAEK,IADL,SACa,OAAO,IAAP,CADb;GAFF;yBAMO,OAAO,IAAP,GAAc,EADrB,kBAEO,QAFP;;UAKQ,KAAR,CAAc,QAAd;MACM,MAAS,OAAT,iBAA4B,IAA5B,UAAoC,OAAO,IAAP,GAAc,EAAlD,CAAN;MACO,OAAP,iBAA0B,IAA1B;SACO,IAAI,OAAJ,CAAY,UAAC,OAAD,EAAU,MAAV,EAAqB;uBACjC,GAAL,EAAU,UAAC,KAAD,EAAQ,MAAR,EAAgB,MAAhB,EAA2B;cAC3B,KAAR,CAAc,OAAd;UACI,KAAJ,EAAW;YACH,MAAM,OAAO,QAAP,EAAZ;YACI,GAAJ,EAAS,CAAT;eACO,OAAO,GAAP,CAAP;;;iBAIN,MADI;cAEQ,MAAR;KAVF;GADK,CAAP;;;AAgBF,AAAO,SAAS,QAAT,CAAkB,MAAlB,EAA0B,MAA1B,EAAkC,KAAlC,EAAyC;SACvC,IAAI,OAAJ,CAAY,UAAC,OAAD,EAAU,MAAV,EAAqB;QAClC,KAAK,GAAG,gBAAH,CAAoB,MAApB,CAAT;OACG,EAAH,CAAM,OAAN,EAAe,MAAf;QACI,KAAK,GAAG,iBAAH,CAAqB,MAArB,CAAT;OACG,EAAH,CAAM,OAAN,EAAe,MAAf;OACG,EAAH,CAAM,QAAN,EAAgB,YAAM;UAChB,CAAC,KAAL,EAAY;wBACI,MAAd,YAA2B,MAA3B;;;KAFJ;OAMG,IAAH,CAAQ,EAAR;GAXK,CAAP;;;AAeF,AAAO,SAAS,OAAT,CAAiB,MAAjB,EAAyB,MAAzB,EAAiC;WAC7B,KAAT,CAAe,IAAf,EAAqB;WACZ,CAAC,OAAO,QAAP,CAAgB,IAAhB,CAAR;;SAEK,IAAI,OAAJ,CAAY,UAAC,OAAD,EAAU,MAAV,EAAqB;OACnC,OAAH,CAAW,MAAX,EAAmB,UAAC,GAAD,EAAM,GAAN,EAAc;UAC3B,GAAJ,EAAS;eACA,GAAP;;UAEE,UAAU,OAAO,MAArB,EAA6B;cACrB,IAAI,MAAJ,CAAW,KAAX,CAAN;;cAEM,GAAR;KAPF;GADK,CAAP;;;AAaF,AAAO,SAAS,KAAT,CAAe,CAAf,EAAkB;SAChB,IAAI,OAAJ,CAAY,UAAC,OAAD,EAAU,MAAV,EAAqB;OACnC,KAAH,CAAS,CAAT,EAAY,eAAO;aACV,MAAM,OAAO,GAAP,CAAN,GAAoB,SAA3B;KADF;GADK,CAAP;;;AAOF,AAAO,SAAS,MAAT,CAAgB,CAAhB,EAAmB,QAAnB,EAA6B;KAC/B,KAAH,CAAS,CAAT,EAAY,UAAC,GAAD,EAAM,IAAN,EAAe;QACrB,GAAJ,EAAS,SAAS,IAAT,CAAc,IAAd,EAAoB,GAApB,EAAT,KACK,IAAI,KAAK,WAAL,EAAJ,EAAwB,MAAM,CAAN,EAAS,QAAT,EAAxB,KACA,GAAG,MAAH,CAAU,CAAV,EAAa,QAAb;GAHP;;;AAOF,AAAO,SAAS,KAAT,CAAe,GAAf,EAAoB,QAApB,EAA8B;KAChC,OAAH,CAAW,GAAX,EAAgB,UAAC,GAAD,EAAM,KAAN,EAAgB;QAC1B,GAAJ,EAAS,SAAS,IAAT,CAAc,IAAd,EAAoB,GAApB,EAAT,KACK,IAAI,MAAM,MAAV,EAAkB;UACjB,CAAJ,EAAO,CAAP;WACK,IAAI,IAAI,MAAM,MAAnB,EAA2B,GAA3B,GAAiC;eACxB,KAAK,GAAL,EAAU,MAAM,CAAN,CAAV,CAAP,EAA4B,eAAO;cAC7B,GAAJ,EAAS,SAAS,IAAT,CAAc,IAAd,EAAoB,GAApB,EAAT,KACK,IAAI,EAAE,CAAF,KAAQ,CAAZ,EAAe,GAAG,KAAH,CAAS,GAAT,EAAc,QAAd;SAFtB;;KAHC,MASA,GAAG,KAAH,CAAS,GAAT,EAAc,QAAd;GAXP;;;AAeF,AAAO,SAAS,UAAT,CAAoB,IAApB,EAA0B;SACxB,KAAK,OAAL,CAAa,IAAb,MAAuB,KAAvB,IAAgC,KAAK,OAAL,CAAa,QAAb,IAAyB,CAAhE;;;AAGF,AAAO,SAAS,UAAT,CAAoB,IAApB,EAA0B;SACxB,KAAK,OAAL,CAAa,IAAb,MAAuB,EAAvB,IAA6B,KAAK,OAAL,CAAa,GAAb,MAAsB,CAA1D;;;AAGF,AAAO,SAAS,UAAT,CAAoB,IAApB,EAA0B;;SAExB,KAAK,OAAL,CAAa,GAAb,MAAsB,CAA7B;;;AAGF,AAAO,SAAS,UAAT,CAAoB,GAApB,EAAyB;SACvB,iCAAgC,IAAhC,CAAqC,GAArC;;;;AAGT,AAAO,SAAS,UAAT,CAAoB,GAApB,EAAyB;SACvB,YAAW,IAAX,CAAgB,GAAhB;;;;AAGT,AAIA,AAAO,SAAS,QAAT,CAAkB,GAAlB,EAAuB,GAAvB,EAA4B;SAC1B,KAAK,QAAL,CAAc,GAAd,EAAmB,GAAnB,CAAP;;;;;;;;;;;;;;;;AAgBF,AAAO,SAAS,UAAT,CAAoB,GAApB,EAAyB,MAAzB,EAAiC;;MAElC,CAAC,IAAI,MAAL,IAAe,CAAC,MAApB,EAA4B;QACtB,0CAAJ,EAAgD,CAAhD;WACO,GAAP;;;MAGE,MAAM,EAAV;;MAEI,MAAJ,CAAW,UAAC,IAAD,EAAO,IAAP,EAAa,GAAb,EAAqB;QAC1B,KAAK,OAAL,CAAa,MAAb,MAAyB,CAA7B,EAAgC;UAC1B,IAAI,IAAJ,CAAJ,EAAe;YACT,MAAM,OAAN,CAAc,IAAI,IAAJ,EAAU,QAAV,CAAd,CAAJ,EAAwC;cAClC,IAAJ,EAAU,QAAV,EAAoB,IAApB,CAAyB,KAAK,KAAL,CAAW,OAAO,MAAlB,CAAzB;SADF,MAEO;cACD,IAAJ,EAAU,QAAV,IAAsB,CAAC,KAAK,KAAL,CAAW,OAAO,MAAlB,CAAD,CAAtB;;;aAGG,IAAP;KARF,MASO;UACD,IAAJ,IAAY,EAAZ;aACO,IAAP;;GAZJ,EAcG,IAAI,CAAJ,CAdH;;SAgBO,GAAP;;;AAGF,AAAO,SAAS,cAAT,CAAwB,GAAxB,EAA6B;MAC9B,CAAC,OAAO,IAAP,CAAY,GAAZ,EAAiB,MAAtB,EAA8B;WACrB,EAAP;;MAEE,0BAAJ;GAGC,QAAD,EAAW,UAAX,EAAuB,OAAvB,EAAgC,GAAhC,CAAoC,gBAAQ;QACtC,IAAI,IAAJ,EAAU,MAAd,EAAsB;UAChB,IAAJ,EAAU,GAAV,CAAc,gBAAQ;4BAEpB,KAAK,IADL,SACa,KAAK,KADlB,UAC4B,IAD5B;OADF;;GAFJ;SAQO,GAAP;;;AAGF,AAAO,SAAS,cAAT,CAAwB,GAAxB,EAA6B;MAC9B,CAAC,IAAI,MAAT,EAAiB;WACR,EAAP;;MAEE,gCAAJ;MAII,GAAJ,CAAQ,gBAAQ;wBAEV,IADJ;GADF;SAIO,GAAP;;;AAGF,AAAO,SAAS,oBAAT,CAA8B,GAA9B,EAAmC;MACpC,CAAC,OAAO,IAAP,CAAY,GAAZ,EAAiB,MAAtB,EAA8B;WACrB,EAAP;;MAEE,iCAAJ;SAIO,IAAP,CAAY,GAAZ,EAAiB,GAAjB,CAAqB,gBAAQ;wBAEvB,IADJ,YACc,IAAI,IAAJ,CADd;GADF;SAIO,GAAP;;;IChVmB;kBAEP,IAAZ,EAAkB;;;;;;;;;;;SASX,WAAL,GAAmB,CAAC,IAAI,cAAJ,CAAD,CAAnB;QACI,KAAK,QAAT,EAAmB;WACZ,WAAL,CAAiB,IAAjB,CACE,KAAK,KAAK,IAAL,CAAU,SAAf,EAA0B,KAAK,QAA/B,EAAyC,cAAzC,CADF;;SAIG,WAAL,CAAiB,IAAjB,CAAsB,KAAK,KAAK,IAAL,CAAU,KAAf,EAAsB,cAAtB,CAAtB;SACK,WAAL,CAAiB,IAAjB,CAAsB,EAAtB,EAhBgB;;SAkBX,IAAL,GAAY,IAAZ;;;;;wBAGE,MAAM,MAAM;UACV,YAAJ;;UAEI,WAAW,IAAX,CAAJ,EAAsB;;YAEhB;cACI,aAAa,IAAI,KAAK,IAAL,CAAU,KAAV,CAAgB,KAApB,CAAnB;cACM,QAAQ,QAAQ,OAAR,CAAgB,KAAK,UAAL,EAAiB,IAAjB,CAAhB,CAAd;gBACM,UAAN;SAHF,CAIE,OAAO,CAAP,EAAU;cACN;gBACI,YAAY,KAAK,KAAK,IAAL,CAAU,IAAV,CAAe,SAApB,EAA+B,KAAK,IAAL,CAAU,QAAzC,EAAmD,KAAK,IAAL,CAAU,KAAV,CAAgB,KAAnE,CAAlB;gBACM,SAAQ,QAAQ,OAAR,CAAgB,KAAK,SAAL,EAAgB,IAAhB,CAAhB,CAAd;kBACM,SAAN;WAHF,CAIE,OAAO,CAAP,EAAU;wCACe,IAAzB,uBAA8C,KAAK,IAAL,CAAU,QAAxD,SAAqE,CAArE;;;OAZN,MAeO;;;;;;+BACY,KAAK,WAAtB,8HAAmC;gBAA1B,IAA0B;;gBAC7B,KAAK,KAAK,IAAL,EAAW,IAAX,CAAT;gBACI;kBACE,UAAQ,QAAQ,OAAR,CAAgB,EAAhB,CAAZ;;kBAEI,OAAJ,EAAW;sBACH,OAAO,IAAP,GAAc,QAApB;;;aAJJ,CAOE,OAAO,CAAP,EAAU;;;;;;;;;;;;;;;;;aAKT,GAAP;;;;;;ICpDiB;kBAEL;;;SACP,KAAL,GAAa,EAAb;;;;;wBAGQ,MAAM,MAAM;;eAkBL,IAAf,CAAoB,KAApB,EAA2B,KAA3B;;;;kBACU,QAAQ,KAAhB;gBADF,GAEe,UAAU,KAAV,CAFf;;cAGM,MAAJ;;qBACkB,KAAK,KAAL,CADlB;;kBACM,GAAJ;kBACI,IAAJ,GAAW,KAAX;kBACI,IAAJ,GAAW,KAAX;;;;;;;;;;;YArBA,KAAK,KAAL,IAAc,KAAK,KAAL,CAAW,IAAX,CAAlB,EAAoC;iBAC3B,KAAK,KAAL,CAAW,IAAX,CAAP;;;;;cAKQ;gBACF,IADE;eAEH,EAFG;gBAGF,EAHE;gBAIF;;;;;;;;;;YAgBJ,SAAS,OAAb;iBACQ,KAAK,IAAI,KAAK,KAAL,CAAW,KAAf,EAAsB,IAAtB,CAAL,EAAkC,IAAlC,CADR;;;YAKI,CAAC,IAAI,GAAL,IAAY,KAAK,QAAjB,IAA6B,KAAK,QAAL,KAAkB,EAAnD;iBACQ,KAAK,KACT,KAAK,IAAL,CAAU,SADD,EAET,KAAK,QAFI,EAGT,KAAK,KAAL,CAAW,KAHF,EAIT,IAJS,CAAL,EAIG,UAJH,CADR;;;YASI,CAAC,IAAI,GAAL,IAAY,SAAS,QAAzB;iBACQ,KAAK,KAAK,KAAK,IAAL,CAAU,KAAf,EAAsB,IAAtB,CAAL,EAAkC,QAAlC,CADR;;;eAIO,GAAP;;;;;wBAGQ,MAAM,WAAW;;eAQV,OAAf,CAAuB,IAAvB,EAA6B,IAA7B;;;;iBACqB,MAAM,IAAN,CADrB;;gBAAA;kBAAA;kBAGM,MAHN;;;;qBAIqB,QAAQ,IAAR,CAJrB;;;yBAKe,SAAS,MAAT,CAAgB,UAAhB,CAAX;;;;uBACI,SAAJ,EAAe;qBACJ,GAAT,CAAa,gBAAQ;qBACZ,SAAS,IAAT,EAAe,KAAf,CAAP;oBACM,IAAN,EAAY,GAAZ,CAAgB,IAAhB;aAFF;WADF;;0BAKW,SAAS,MAAb;qBACC,QAAQ,GAAR,CAAY,SAAS,GAAT,CAAa,UAAO,IAAP;;yBACc,KAAK,KAAK,IAAL,EAAW,IAAX,CAAL,CADd;;wBACvB,KAAN,CAAY,SAAS,IAAT,EAAe,KAAf,CAAZ;;eADgB,CAAZ,CADD;;;;;;;;;;;;;;;;;;;;;;;;;;gBAjBC;iBACH,IAAI,GAAJ,EADG;kBAEF,IAAI,GAAJ,EAFE;oBAGA,IAAI,GAAJ;;;;;;;;YAuBR,KAAK,QAAL,IAAiB,KAAK,QAAL,KAAkB,EAAvC;iBACQ,QAAQ,KACZ,KAAK,IAAL,CAAU,SADE,EAEZ,KAAK,QAFO,EAGZ,KAAK,KAAL,CAAW,KAHC,CAAR,EAGe,UAHf,CADR;;;eAQM,QAAQ,KAAK,KAAK,IAAL,CAAU,KAAf,CAAR,EAA+B,QAA/B;;eAGA,QAAQ,IAAI,KAAK,KAAL,CAAW,KAAf,CAAR,EAA+B,OAA/B;;;YAEF,aAAJ,EAAmB;;;;;;6BACA,MAAM,QAAN,CAAe,MAAf,EAAjB,uHAA0C;kBAAA;;kBACpC,MAAM,KAAN,CAAY,GAAZ,CAAgB,IAAhB,CAAJ,EAA2B;sBACnB,QAAN,CAAe,MAAf,CAAsB,IAAtB;;;;;;;;;;;;;;;;;;;;;;;8BAGa,MAAM,MAAN,CAAa,MAAb,EAAjB,2HAAwC;mBAAA;;kBAClC,MAAM,KAAN,CAAY,GAAZ,CAAgB,KAAhB,CAAJ,EAA2B;sBACnB,MAAN,CAAa,MAAb,CAAoB,KAApB;;kBAEE,MAAM,QAAN,CAAe,GAAf,CAAmB,KAAnB,CAAJ,EAA8B;sBACtB,MAAN,CAAa,MAAb,CAAoB,KAApB;;;;;;;;;;;;;;;;;;;YAKF,SAAJ,EAAe;iBACN,IAAP,CAAY,KAAZ,EAAmB,GAAnB,CAAuB,gBAAQ;kBACvB,IAAN,IAAc,MAAM,IAAN,CAAW,MAAM,IAAN,CAAX,CAAd,CAD6B;;;;uCAIpB,CAJoB,EAIb,GAJa;kBAKvB,QAAQ,EAAZ;kBACI,cAAc,EAAlB;kBACI,KAAK,KAAT,EAAgB;uBACP,IAAP,CAAY,KAAK,KAAjB,EAAwB,GAAxB,CAA4B,aAAK;;;;;;;sBAO3B,KAAK,KAAL,CAAW,CAAX,MAAkB,MAAM,IAAN,EAAY,CAAZ,CAAtB,EAAsC;4BAC5B,CAAR;;iBARJ;;;oBAaI,IAAN,EAAY,CAAZ,IAAiB;sBACT,MAAM,IAAN,EAAY,CAAZ,CADS;uBAER,KAFQ;sBAGT;eAHR;;;iBAjBG,IAAI,IAAI,CAAR,EAAW,MAAM,MAAM,IAAN,EAAY,MAAlC,EAA0C,IAAI,GAA9C,EAAmD,GAAnD,EAAwD;oBAA/C,CAA+C,EAAxC,GAAwC;;WAJ1D;;;eA8BK,YAAY,KAAZ,GAAoB,MAAM,KAAjC;;;;;wBAGE,MAAM,KAAK,SAAS;UAClB,UAAU,QAAQ,GAAR,IAAe,KAAK,KAAL,CAAW,IAAX,CAA7B;UACM,SAAS,IAAI,MAAJ,CAAW,IAAI,OAAf,CAAf;;eAES,cAAT,CAAwB,GAAxB,EAA6B;;YAEvB,WAAW,OAAO,GAAP,CAAW,GAAX,EAAgB,QAAQ,IAAxB,CAAf;YACI,YAAY,aAAa,QAA7B,EAAuC;iBAC9B,QAAQ,KAAK,QAAL,EAAe,GAAf,CAAR,CAAP;SADF,MAEO;iBACE,MAAM,QAAQ,GAAR,CAAN,GAAqB,OAA5B;;;;UAIA,oIAIiB,QAAQ,IAJzB,eAIuC,QAAQ,IAJ/C,GAIsD,QAAQ,MAJ9D,0CAME,OANF,+GAAJ;;SAaG,gBAAH,CAAoB,IAApB,EAA0B;kBACX,QAAQ,IAArB,QADwB;oBAEZ,CAAC,CAFW;uBAGT;OAHjB,EAIG,cAJH,EAImB,GAJnB;;;;;;ACnLJ,IAAI,SAAS,EAAb;;AAEA,aAAe,UAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAmB;WACvB,MAAM,GAAN,GAAY,MAArB;OACK,GAAL,EAAU,GAAV,EAAe,IAAf;CAFF;;;;AAOA,SAAS,IAAT,CAAc,GAAd,EAAmB,GAAnB,EAAwB;MAChB,OAAO,GAAG,QAAH,CAAY,GAAZ,CAAb;;MAEI,KAAK,WAAL,EAAJ,EAAwB;WACf,GAAG,WAAH,CAAe,GAAf,EAAoB,MAApB,CAA2B,aAAK;UACjC,OAAO,QAAP,CAAgB,CAAhB,CAAJ,EAAwB;eACf,KAAP;OADF,MAEO,IAAI,EAAE,CAAF,MAAS,GAAT,IAAgB,OAAO,QAAP,CAAgB,GAAhB,CAApB,EAA0C;eACxC,KAAP;OADK,MAEA;eACE,IAAP;;KANG,EAQJ,GARI,CAQA,aAAK;UAER,OAAO,KAAK,IAAL,CAAU,GAAV,EAAe,CAAf,CADT;UAEE,OAAO,KAAK,IAAL,CAAU,GAAV,EAAe,CAAf,CAFT;UAGE,OAAO,GAAG,QAAH,CAAY,IAAZ,CAHT;UAIE,iBAJF;UAKE,iBALF;;UAOI,KAAK,WAAL,EAAJ,EAAwB;aACjB,IAAL,EAAW,IAAX,EAAiB,IAAjB;OADF,MAEO;gBACC,IAAN,EAAY,IAAZ;;KAnBG,CAAP;GADF,MAuBO;WACEC,QAAM,GAAN,EAAW,KAAK,IAAL,CAAU,GAAV,EAAe,KAAK,QAAL,CAAc,GAAd,CAAf,CAAX,CAAP;;;;AAIJ,SAASA,OAAT,CAAe,GAAf,EAAoB,GAApB,EAAyB;MAErB,iBADF;MAEE,iBAFF;;aAIW,GAAG,gBAAH,CAAoB,GAApB,CAAX;aACW,GAAG,iBAAH,CAAqB,GAArB,CAAX;WACS,IAAT,CAAc,QAAd;;MAEI,QAAQ,KAAK,QAAL,CAAc,QAAQ,GAAR,EAAd,EAA6B,GAA7B,CAAZ;UACQ,GAAR,gBAAyB,KAAzB;;;AAGF,SAAS,IAAT,CAAc,GAAd,EAAmB,GAAnB,EAAwB,EAAxB,EAA4B;MACtB;OACC,UAAH,CAAc,GAAd;OACG,GAAH,EAAQ,GAAR;GAFF,CAGE,OAAO,CAAP,EAAU;OACP,SAAH,CAAa,GAAb;OACG,GAAH,EAAQ,GAAR;;;;;;;;ICxDiB;sBAEL;;;;;;yBAGH,MAAM,KAAK;;;UAChB,CAAC,IAAL,EAAW;eACF,KAAP;OADF;WAAA,GAGU,KAHV;WAAA,GAIY,KAAK,KAAK,IAAL,CAAU,SAAf,EAA0B,IAA1B,CAJZ;WAAA,GAKY,UAAU,GAAV,CALZ;;;YAOI,GAAJ,EAAS;gBACF,GAAL,EAAU,GAAV,EAAe,CAAC,cAAD,EAAiB,KAAjB,EAAwB,MAAxB,CAAf;iBACO,IAAP;SAFF;iBAIO,GAAP;;;;;;wBAGQ;;;eACc,QAAQ,KAAK,KAAK,IAAL,CAAU,SAAf,CAAR;;;;oBACV,UAAU,MAAV,CAAiB,UAAjB,CAAZ;eACO,SAAP;;;;;;;AC3BG,IAAM,iBAAiB;;qBAET,GAFS;SAGrB;WACE,MADF;aAEI;GALiB;QAOtB;UACE,QADF;WAEG,cAFH;eAGO;GAVe;UAYpB;UACA,IADA;UAEA,WAFA;UAGA;GAfoB;OAiBvB;WACI,KADJ;;aAGM;;CApBN;;AAwBP,AAAO,SAAS,UAAT,CAAoB,IAApB,EAA0B;SACxB,MAAM,cAAN,EAAsB,QAAQ,EAA9B,CAAP;;;;;ACZF,IAAI,s2BAAJ;;AAwBA,IAAM,OAAO,IAAI,IAAJ,EAAb;AACA,IAAM,WAAW,IAAI,QAAJ,EAAjB;;IAEqB;eAEP,KAAZ,EAAmB;;;;;SACZ,KAAL,GAAa,KAAb;SACK,IAAL,GAAY,IAAZ;SACK,GAAL,GAAW,GAAX;SACK,OAAL,GAAe,EAAf;SACK,CAAL,GAAS;cAAA,EACF,QADE,EACG,UADH,EACS,YADT,EACgB,oBADhB,EAC2B,gBAD3B;cAAA,EAEF,YAFE,EAEK,UAFL,EAEW,YAFX,EAEkB,gBAFlB,EAE2B,kBAF3B;4BAAA,EAGK;KAHd,CAMI;;cAEO,OAAL;eACM,MAAK,MAAL,EAHR;;eAIQ,MAAK,IAAL,EAJR;;eAKQ,MAAK,IAAL,EALR;;eAMQ,MAAK,OAAL,EANR;;eAOQ,MAAK,MAAL,EAPR;;eAQQ,MAAK,GAAL,EARR;;eASQ,MAAK,IAAL,EATR;;eAUQ,MAAK,GAAL,EAVR;;cAWO,MAAL;cACK,OAAL;eACM,MAAK,GAAL,EAbR;yBAcS,CAdT;YAeM,CAAJ,EAAO,CAAP;;;;;;;gCAKE;UACJ,CAAC,KAAK,IAAV,EAAgB;;UAEZ,KAAK,KAAL,CAAW,CAAX,MAAkB,IAAlB,IACC,KAAK,KAAL,CAAW,CAAX,MAAkB,WADvB,EACoC;aAC7B,IAAL,GAAY,KAAZ;gBACQ,GAAR,CAAYC,OAAZ;;;;;;;;;aAKE,CAAC,OAAK,IAAV;;cAEI,CAAC,OAAK,KAAL,CAAW,MAAZ,IACC,OAAK,KAAL,CAAW,CAAX,MAAkB,IADnB,IAEC,OAAK,KAAL,CAAW,CAAX,MAAkB,QAFvB;;qBAGO,IAAL,GAAY,KAAZ;;qBAE8B,KAAK,GAAL,CAAS,OAAK,OAAd,EAAuB,IAAvB,EAA6B,IAA7B,CALhC;;uBAKW,qBAAT;qBAC8B,SAAS,GAAT,CAAa,OAAK,OAAlB,CANhC;;uBAMW,qBAAT;;sBAGQ,GAAR,CAAY,KAAZ;;;;;;;;;;;;;;;;;aAKE,CAAC,QAAK,IAAV;;;;;;+BAAA,GAK0B,IAAI,eAAe,KAAf,CAAqB,OAAzB,CAL1B;uBAMqB,MAAM,eAAN,CANrB;;uBAMO,KAAL;2BANF,GAOsB,OAAK,KAAL,GAAa,QAAQ,eAAR,CAAb,GAAwC,IAP9D;;;;uBAUO,OAAL,GAAe,WAAW,WAAX,CAAf;;oBAVF,GAaa,MAAM,OAAK,OAAL,CAAa,IAAnB,CAbb;;;uBAeS,IAAP,CAAY,IAAZ,EAAkB,GAAlB,CAAsB,gBAAQ;sBACxB,CAAC,WAAW,KAAK,IAAL,CAAX,CAAL,EAA6B;yBACtB,IAAL,IAAa,IAAI,KAAK,IAAL,CAAJ,CAAb;;iBAFJ;;;oBAOI,eAAe,YAAY,QAA/B,EAAyC;yBAClC,OAAL,CAAa,mBAAb,IAAoC,KAClC,KAAK,SAD6B,EAElC,YAAY,QAFsB,EAGlC,cAHkC,CAApC;;qCADuC,GAOX,KAC1B,KAAK,SADqB,EAE1B,YAAY,QAFc,EAG1B,OAAK,OAAL,CAAa,KAAb,CAAmB,OAHO,CAPW;;;sBAanC,UAAU,mBAAV,CAAJ,EAAoC;mCAAA,GACV,QAAQ,mBAAR,CADU;;;0BAG5B,OAAK,OAAX,EAAoB,eAApB;;;;sBAIE,OAAK,OAAX,EAAoB,WAApB;;uBAEO,IAAP,CAAY,OAAK,OAAL,CAAa,IAAzB,EAA+B,GAA/B,CAAmC,gBAAQ;sBACrC,CAAC,WAAW,OAAK,OAAL,CAAa,IAAb,CAAkB,IAAlB,CAAX,CAAL,EAA0C;2BACnC,OAAL,CAAa,IAAb,CAAkB,IAAlB,IAA0B,IAAI,OAAK,OAAL,CAAa,IAAb,CAAkB,IAAlB,CAAJ,CAA1B;;iBAFJ;;;6BAKO,CAjDT;gBAkDM,CAAJ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;aAKE,CAAC,QAAK,IAAV;;oBAEI,QAAK,KAAL,CAAW,CAAX,MAAkB,GAAlB,IAAyB,QAAK,KAAL,CAAW,CAAX,MAAkB,SAF/C;;;sBAGO,IAAL,GAAY,KAAZ;;mBAHF,GAKc,QAAK,KAAL,CAAW,CAAX,MAAkB,IAAlB,IAA0B,QAAK,KAAL,CAAW,CAAX,MAAkB,QAL1D;uBAAA,GAOkB,EAPlB;sBAAA,GAQiB,EARjB;sBAAA,GASiB,EATjB;kBAAA,GAUe,QAAK,OAVpB;;;;;4BAaY,MAAM,IAAI,cAAJ,CAAN,CAbZ;;uBAawC;0BACxB,QAAQ,IAAI,cAAJ,CAAR,EAA6B,eAAzC;;;;8BAIE,KAAK,QAlBX;;;;uBAAA,GAmBoB,KAAK,KAAK,IAAL,CAAU,SAAf,EAA0B,KAAK,QAA/B,EAAyC,cAAzC,CAnBpB;uBAoBgC,MAAM,OAAN,CApBhC;;6BAAA;;;;0BAqBQ,aAAJ,EAAmB;yBAAA,GACG,QAAQ,OAAR,EAAiB,iBAAjB,CADH;;yBAEN,MAAM,WAAN,EAAmB,SAAnB,CAAX;;0BAEE,OAAO,IAAP,CAAY,QAAZ,EAAsB,MAA1B;wBAAA,GACmB,QAAQ,OAAR,CADnB;;yBAEa,iBAAX,IAAgC,QAAhC;qBACM,MAAM,OAAN,EAAe,KAAK,SAAL,CAAe,UAAf,EAA2B,IAA3B,EAAiC,CAAjC,CAAf,CAHR;;;;;;;2BAAA,GASgB,KAAK,KAAK,IAAL,CAAU,KAAf,EAAsB,cAAtB,CAThB;2BAU4B,MAAM,OAAN,CAV5B;;iCAAA;;;;8BAWI,aAAJ,EAAmB;6BAAA,GACG,QAAQ,OAAR,EAAiB,eADpB;;6BAEN,MAAM,WAAN,EAAmB,SAAnB,CAAX;;8BAEE,OAAO,IAAP,CAAY,QAAZ,EAAsB,MAA1B;4BAAA,GACmB,QAAQ,OAAR,CADnB;;6BAEa,iBAAX,IAAgC,QAAhC;yBACM,MAAM,OAAN,EAAe,KAAK,SAAL,CAAe,UAAf,EAA2B,IAA3B,EAAiC,CAAjC,CAAf,CAHR;;;;;;;oBAxCJ,GA+Ce,KAAK,GA/CpB;uBAiD0B,OAAO,IAAP,CAAY,QAAZ,EAAsB,MAAtB,GACdC,QAAQ,QAAR,EAAkB,KAAK,KAAK,IAAL,CAAU,SAAf,EAA0B,KAAK,QAA/B,CAAlB,EAA4D,KAAK,KAAjE,EAAwE,KAAK,OAA7E,CADc,GAEpB,QAAQ,OAAR,EAnDN;;+BAAA;uBAqD0B,OAAO,IAAP,CAAY,QAAZ,EAAsB,MAAtB,GACdA,QAAQ,QAAR,EAAkB,KAAK,IAAL,CAAU,KAA5B,EAAmC,KAAK,KAAxC,EAA+C,KAAK,OAApD,CADc,GAEpB,QAAQ,OAAR,EAvDN;;+BAAA;;;;wBA0DU,GAAR,CAAY,CAAC,eAAD,EAAkB,eAAlB,CAAZ,EAAgD,IAAhD,CAAqD,eAAO;sBACtD,4BAAJ,EAAkC,CAAlC;iBADF,EAEG,KAFH,CAES,eAAO;sBACV,GAAJ,EAAS,CAAT;iBAHF;;;;;;;;;;;;;;;;aAUE,CAAC,QAAK,IAAV;mBAEI,QAAK,KAAL,CAAW,CAAX,MAAkB,MAFtB;;;;oBAGO,IAAL,GAAY,KAAZ;;;wBAEI,CAAC,QAAK,KAAL,CAAW,CAAX,CAAL,EAAoB;mBACX,uCAAuC,CAAvC,CAAP;WADF;;;oBAAA,GAKe,QAAK,KAAL,CAAW,CAAX,CALf;uBAMmB,SAAS,IAAT,CAAc,IAAd,EAAoB,KAApB,EAA2B,QAAK,OAAhC,CANnB;;oBAAA;;oBAOM,IAAJ,EAAU;sCACS,IAAjB,gCAAiD,CAAjD;iBADF,MAEO;sCACY,IAAjB,mBAAoC,CAApC;;iCAEK,CAZT;oBAaM,CAAJ;;;;;;;;;;;;;;;;aAMA,CAAC,QAAK,IAAV;;;gBAEI,QAAK,KAAL,CAAW,CAAX,MAAkB,SAAtB;;;;;yBACO,IAAL,GAAY,KAAZ;;sBADF,GAGa,OAAK,KAAL,CAAW,KAAX,CAAiB,CAAjB,CAHb;;sBAIM,CAAC,KAAK,MAAV,EAAkB;qDACiB,CAAjC;4BACQ,IAAR,CAAa,CAAb;;4BANJ,GAQmB,OAAK,OAAL,CAAa,IAAb,CAAkB,KARrC;2BAAA;2BAUM,KAAK,CAAL,EAAQ,OAAR,CAAgB,GAAhB,MAAyB,CAV/B;;;gCAWgB,KAAK,CAAL,EAAQ,KAAR,CAAc,CAAd,CAAZ;2BACO,KAAK,MAAL,CAAY,CAAZ,EAAe,CAAf,CAAP;;;qCACI,cAAc,EAbtB;qCAcU,KAAK,MAdf;;;;6BAeiC,MAAM,KAAK,OAAK,OAAL,CAAa,IAAb,CAAkB,SAAvB,EAAkC,SAAlC,CAAN,CAfjC;;gCAAA;;;;gCAgBY,UAAJ,EAAgB;iCACD,KAAK,OAAK,OAAL,CAAa,IAAb,CAAkB,SAAvB,EAAkC,SAAlC,EAA6C,OAAK,OAAL,CAAa,KAAb,CAAmB,KAAhE,CAAb;mBADF;gCAEO;0CACY,SAAjB,mBAAyC,CAAzC;8BACQ,IAAR,CAAa,CAAb;;;gCAEG;mEACwC,CAA7C;8BACQ,IAAR,CAAa,CAAb;;;gCAGC;mEAC0C,CAA7C;8BACQ,IAAR,CAAa,CAAb;;;yBAGgB,QAAQ,UAAR,CAhCtB;;uBAAA;;uBAiCO,GAAL,CAAS,UAAO,IAAP;2BACA,OAAO,KAAd;wBACI,MAAM,QAAN,CAAe,IAAf,CAAJ,EAA0B;0BACpB;+BACK,KAAK,UAAL,EAAiB,IAAjB,CAAP,EAA+B,eAAO;8BAChC,GAAJ,EAAS;gCACH,GAAJ,EAAS,CAAT;;wCAEU,SAAS,IAAT,EAAe,KAAf,CAAZ,UAAqC,YAAY,QAAQ,SAAR,GAAoB,GAAhC,GAAsC,EAA3E,eAAwF,CAAxF;yBAJF;uBADF,CAOE,OAAO,CAAP,EAAU;4BACN,CAAJ,EAAO,CAAP;;qBATJ,MAWO;sCACQ,SAAS,IAAT,EAAe,KAAf,CAAb,YAAuC,YAAY,QAAQ,SAAR,GAAoB,GAAhC,GAAsC,EAA7E,kBAA6F,CAA7F;;mBAdJ;;;;;gBAmBE,QAAK,KAAL,CAAW,CAAX,MAAkB,SAAtB;;;;yBACO,IAAL,GAAY,KAAZ;;sBADF,GAGe,OAAK,KAAL,CAAW,KAAX,CAAiB,CAAjB,CAHf;;sBAIM,CAAC,KAAK,MAAV,EAAkB;qDACiB,CAAjC;4BACQ,IAAR,CAAa,CAAb;;yBAEkB,QAAQ,OAAK,OAAL,CAAa,IAAb,CAAkB,SAA1B,CARtB;;uBAAA;;uBASO,GAAL,CAAS,UAAO,IAAP;wBACH,MAAM,QAAN,CAAe,IAAf,CAAJ,EAA0B;0BACpB;8BACI,KAAK,OAAK,OAAL,CAAa,IAAb,CAAkB,SAAvB,EAAkC,IAAlC,CAAN,EAA+C,eAAO;8BAChD,GAAJ,EAAS;gCACH,GAAJ,EAAS,CAAT;;8CAEe,IAAjB,iBAAkC,CAAlC;yBAJF;uBADF,CAOE,OAAO,CAAP,EAAU;4BACN,CAAJ,EAAO,CAAP;;qBATJ,MAWO;0CACY,IAAjB,mBAAoC,CAApC;;mBAbJ;;;;;;;;;;;;;;;;;;aAoBE,CAAC,QAAK,IAAV;mBAEI,QAAK,KAAL,CAAW,CAAX,MAAkB,KAFtB;;;oBAGO,IAAL,GAAY,KAAZ;;;wBAEI,CAAC,QAAK,KAAL,CAAW,CAAX,CAAL,EAAoB;mBACX,sCAAsC,CAAtC,CAAP;WADF;;kBAAA,GAIa,QAAK,KAAL,CAAW,CAAX,CAJb;kBAAA,GAKW,OALX;;;0BAMI,QAAK,KAAL,CAAW,CAAX,MAAkB,IAAtB,EAA4B;qBACnB,QAAP;aADF;;oBAEW,QAAK,KAAL,CAAW,CAAX,MAAkB,IAAtB,EAA4B;yBAC1B,UAAP;;;;;;uBAGoB,KAAK,GAAL,CAAS,IAAT,EAAe,IAAf,EAAqB,QAAK,OAA1B,CAZtB;;uBAAA;;oCAakB,QAAQ,IAA1B;oBACO,QAAQ,IAAf,cAA4B,IAA5B,wBAEJ,QAAQ,GAFJ;;;;;;;;;;;;;;;;;aAQE,CAAC,QAAK,IAAV;;qBAEI,QAAK,KAAL,CAAW,CAAX,MAAkB,IAAlB,IACC,QAAK,KAAL,CAAW,CAAX,MAAkB,MAHvB;;;;wBAIO,IAAL,GAAY,KAAZ;;uBAEiC,KAAK,GAAL,CAAS,QAAK,OAAd,EAAuB,IAAvB,EAA6B,KAA7B,CANnC;;sBAAA,GAMc,qBANd;uBAQgC,SAAS,GAAT,CAAa,QAAK,OAAlB,CARhC;;;0BAQW,qBAAT;;;;6BAEU,MAAM,IAAI,cAAJ,CAAN,CAVZ;;;;;oBAAA,GAWmB,QAAQ,IAAI,cAAJ,CAAR,CAXnB;;;2BAYQ,OAAO,OAAP,IAAkB,OAAO,IAAP,CAAY,OAAO,OAAnB,EAA4B,MAA5B,GAAqC,CAA3D,EAA8D;wBACnD,qBAAqB,OAAO,OAA5B,CAAT;;;;;;;sBAOI,GAAR,CAAY,MAAZ;;;;;;;;;;;;;;;;aAKE,CAAC,QAAK,IAAV;;;gBAEI,QAAK,KAAL,CAAW,CAAX,MAAkB,UAAtB;;;;yBACO,IAAL,GAAY,KAAZ;;;sBADF,GAIe,OAAK,KAAL,CAAW,CAAX,KAAiB,SAAS,KAAT,EAAgB,EAAhB,CAJhC;yBAKwB,MAAM,KAAK,OAAK,OAAL,CAAa,IAAb,CAAkB,SAAvB,EAAkC,IAAlC,CAAN,CALxB;;yBAAA;;;sBAOM,OAAJ,EAAa;;0CACM,IAAjB,8EAA6F,CAAC,CAA9F;0BAEE,KAAKC,yBAAgB,QAAQ,KAAxB,EAA+B,QAAQ,MAAvC,CADP;0BAEE,UAAU,CAAC,MAAD,CAFZ;0BAGE,IAAI,CAHN;0BAIE,OAAO,EAJT;0BAKI,MAAM,SAAN,GAAM,GAAY;2BACjB,SAAH,CAAa,QAAQ,CAAR,IAAa,IAA1B;2BACG,MAAH;;;uBAFF;;yBAOG,EAAH,CAAM,MAAN,EAAc,UAAC,IAAD,EAAU;6BACjB,QAAQ,IAAI,CAAZ,CAAL,IAAuB,IAAvB;4BACI,MAAM,QAAQ,MAAlB,EAA0B;iCACjB,GAAG,KAAH,EAAP;;;uBAHJ,EAMG,EANH,CAMM,OANN,EAMe;;;8BACT,KAAK,IAAL,KAAc,GAAlB,EAAuB;kCAChB,KAAL,EAAY,KAAK,OAAK,OAAL,CAAa,IAAb,CAAkB,SAAvB,EAAkC,IAAlC,CAAZ,EAAqD,CAAC,KAAD,EAAQ,MAAR,CAArD;2BADF;gCAEW,KAAK,IAAL,KAAc,EAAlB,EAAsB;kCACvB,sBAAJ,EAA4B,CAA5B;6BADK;;uCAGkB,MAAM,KAAK,OAAK,OAAL,CAAa,IAAb,CAAkB,SAAvB,EAAkC,KAAK,IAAvC,CAAN,CAHlB;;wCAAA;;oCAID,QAAJ,EAAc;sCACL,KAAK,IAAZ,yBAAsC,CAAtC;0CACQ,IAAR,CAAa,CAAb;iCAFF,MAGO;wCACA,KAAL,EAAY,KAAK,OAAK,OAAL,CAAa,IAAb,CAAkB,SAAvB,EAAkC,KAAK,IAAvC,CAAZ,EAA0D,CAAC,KAAD,EAAQ,MAAR,CAA1D;;;;;;uBAjBN;;mBAdF,MAmCO;0BACA,KAAL,EAAY,KAAK,OAAK,OAAL,CAAa,IAAb,CAAkB,SAAvB,EAAkC,IAAlC,CAAZ,EAAqD,CAAC,KAAD,EAAQ,MAAR,CAArD;;;;;;gBAIA,QAAK,KAAL,CAAW,CAAX,MAAkB,UAAtB,EAAkC;sBAC3B,IAAL,GAAY,KAAZ;;kBAEI,CAAC,QAAK,KAAL,CAAW,CAAX,CAAL,EAAoB;4DAC0B,CAA5C;eADF,MAEO;kBAAA,GACI,QAAK,KAAL,CAAW,KAAX,CAAiB,CAAjB,CADJ;;qBAEA,GAAG,MAAH,CAAU,UAAV,CAAL;oBACI,CAAC,GAAG,MAAR,EAAgB;wCACQ,CAAtB;iBADF,MAEO;qBACF,GAAH,CAAO,UAAO,IAAP;;;6BAAA,GACW,KAAK,OAAK,OAAL,CAAa,IAAb,CAAkB,KAAvB,CADX;6BAEuB,MAAM,OAAN,CAFvB;;mCAAA;6BAGoB,MAAM,KAAK,OAAL,EAAc,IAAd,CAAN,CAHpB;;gCAAA;;0BAID,CAAC,aAAL;+BACQ,MAAM,OAAN,CADR;;;;+BAIQ,SAAS,IAAI,IAAJ,CAAT,EAAoB,KAAK,OAAL,EAAc,IAAd,CAApB,EAAyC,OAAzC,CARH;;wCASU,SAAS,IAAT,EAAe,KAAf,CAAb,YAAuC,aAAa,SAAb,GAAyB,OAAhE,GAA2E,CAA3E;yCACO,CAVJ;4BAWC,CAAJ,EAAO,CAAP;;;mBAXJ;;;;;;;;;;6BAmBC;UACH,CAAC,KAAK,IAAV,EAAgB;;UAEZ,KAAK,KAAL,CAAW,CAAX,MAAkB,QAAtB,EAAgC;aACzB,IAAL,GAAY,KAAZ;;YAEM,OAAO,kBAAkB,KAAK,GAAL,EAA/B;;YAEI,yBAAJ,EAA+B,CAA/B;cACK,KAAK,OAAL,CAAa,IAAb,CAAkB,IAAvB,EAA6B,IAAI,IAAJ,CAA7B,EAAwC,CAAC,cAAD,EAAiB,KAAjB,EAAwB,WAAxB,CAAxC;;;;;8BAIM;UACJ,CAAC,KAAK,IAAV,EAAgB;;UAEZ,KAAK,KAAL,CAAW,CAAX,MAAkB,SAAtB,EAAiC;aAC1B,IAAL,GAAY,KAAZ;;YAEI,0BAAJ,EAAgC,CAAhC;cACK,KAAL,EAAY,KAAK,OAAL,CAAa,IAAb,CAAkB,IAA9B,EAAoC,CAAC,cAAD,EAAiB,KAAjB,EAAwB,WAAxB,CAApC;;;;;;;;;;;;WAKE,CAAC,QAAK,IAAV;YAAA,GAEW,QAAK,KAFhB;;YAGI,QAAK,KAAL,CAAW,MAAX,GAAoB,CAAxB,EAA2B;;gBACrB,YAAJ;gBACM,SAAS,OAAK,OAAL,CAAa,iBAA5B;gBACI;oBACI,WAAW,IAAX,EAAiB,MAAjB,CAAN;aADF,CAEE,OAAO,CAAP,EAAU;8CACsB,CAAhC;kBACI,CAAJ;;;gBAGE,OAAO,IAAP,CAAY,GAAZ,EAAiB,MAArB,EAA6B;qBACpB,IAAP,CAAY,GAAZ,EAAiB,GAAjB,CAAqB,UAAO,IAAP;;;;;4BAAA,GAEF,OAFE;8BAAA,GAGA,IAAI,IAAJ,EAAU,QAAV,CAHA;;wBAIb,UAAJ,EAAgB;sCACN,WAAW,CAAX,CADM;;;;oDAEP,GAFO;mCAGC,UAAX;mCACW,MAAX,CAAkB,CAAlB,EAAqB,CAArB;;;;;oDAEG,GANO;mCAOC,QAAX;mCACW,MAAX,CAAkB,CAAlB,EAAqB,CAArB;;;;;2BAIgB,KAAK,GAAL,CAAS,IAAT,EAAe,QAAf,EAAyB,OAAK,OAA9B,CAhBL;;2BAAA;;wBAiBb,QAAQ,GAAZ,EAAiB;8BACP,QAAR,IAAqB,cAAc,WAAW,MAA1B,GAChB,MAAM,MAAN,GAAe,WAAW,IAAX,CAAgB,MAAM,MAAtB,CADC,GAEhB,EAFJ;6BAGK,YAAL,IAAsB,cAAc,WAAW,MAA1B,GACjB,UADiB,GAEjB,IAFJ;2BAGK,GAAL,CAAS,IAAT,UAAqB,OAArB;qBAPF,MAQO;iDACmB,IAAxB,EAAgC,CAAhC;;qCAEK,CA5BU;wBA6Bb,CAAJ,EAAO,CAAP;;;eA7BJ;;;;;;;;IAsCR;;IC1hBqB;iBAEL;;;SACP,GAAL,GAAW,GAAX;;;;;wBAOE,MAAM;UACJ,CAAC,IAAL,EAAW;;;;UAIP,IAAI,GAAR,CAAY,OAAO,IAAP,KAAgB,QAAhB,GAA2B,CAAC,IAAD,CAA3B,GAAoC,IAAhD;;;;wBATe;aACR,GAAP;;;;;;"}